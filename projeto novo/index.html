<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Faxineiras ‚Äî Servi√ßos de Limpeza (Interativo)</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root{
    --bg: #f5f7fa;
    --card: #ffffff;
    --text: #1a1c1e;
    --muted: #8a93a0;
    --primary: #4c9ef5;
    --surface: #ebf0f5;
    --radius: 14px;
    --container: 1100px;
}
[data-theme="dark"]{
    --bg:#0f1720; --card:#0b1220; --text:#e6eef8; --muted:#9aa6b2; --surface:#111827; --primary:#6ea8ff;
}
*{margin:0; padding:0; box-sizing:border-box;}
body{
    font-family:"Inter", sans-serif;
    background:var(--bg);
    color:var(--text);
    display:flex;
    justify-content:center;
    padding:40px 20px;
}
.wrapper{width:100%; max-width:var(--container);}
.header{background:var(--card); padding:22px; border-radius:var(--radius); border:1px solid #dce3eb; display:flex; justify-content:space-between; align-items:center;}
.logo{display:flex; align-items:center; gap:14px;}
.logo-icon{width:50px; height:50px; background:var(--primary); color:white; display:grid; place-items:center; border-radius:12px; font-weight:700; font-size:20px;}
.profile{display:flex; align-items:center; gap:14px;}
.profile-pic{width:46px; height:46px; background:var(--surface); display:grid; place-items:center; border-radius:50%; color:var(--primary); font-weight:600; cursor:pointer; transition:transform .18s ease;}
.profile-pic.open{transform:rotate(180deg);}
.dropdown{position:absolute; right:20px; top:84px; background:var(--card); border-radius:12px; padding:12px; box-shadow:0 6px 18px rgba(0,0,0,0.08); display:none; border:1px solid #dce3eb}
.dropdown.show{display:block}
.search-box{margin-top:20px; background:var(--card); padding:14px 20px; border-radius:var(--radius); border:1px solid #dce3eb; display:flex; gap:12px; position:relative}
.search-box input{flex:1; border:0; background:transparent; outline:0; font-size:15px}
.search-btn{padding:10px 16px; background:var(--primary); border:0; border-radius:10px; color:white; font-weight:600; cursor:pointer}
.autocomplete{position:absolute; left:20px; right:120px; top:64px; background:var(--card); border-radius:10px; box-shadow:0 6px 18px rgba(0,0,0,0.06); overflow:hidden; border:1px solid #dce3eb; display:none}
.autocomplete.show{display:block}
.autocomplete .item{padding:10px 14px; border-bottom:1px solid #eef3f8; cursor:pointer}
.autocomplete .item:last-child{border-bottom:0}
.section-title{margin:28px 0 10px; font-weight:700}
.categories{display:flex; gap:16px; overflow-x:auto; padding-bottom:6px}
.cat{min-width:240px; background:var(--card); border-radius:var(--radius); border:1px solid #dce3eb; padding:18px; display:flex; flex-direction:column; gap:12px; transition:transform .18s ease, box-shadow .18s ease, background .18s ease; position:relative}
.cat:hover{transform:translateY(-6px); box-shadow:0 12px 30px rgba(16,40,80,0.06);}
.cat-icon{width:50px; height:50px; display:grid; place-items:center; border-radius:10px; background:var(--primary); color:white; font-size:22px; transition:transform .28s cubic-bezier(.2,.9,.2,1)}
.cat:hover .cat-icon{animation:bounce .6s}
@keyframes bounce{0%{transform:translateY(0)}30%{transform:translateY(-6px)}60%{transform:translateY(0)}100%{transform:translateY(0)}}
.cat-label{font-weight:700}
.stars{color:#ffc107; font-size:15px; margin-top:4px}
.btn-agendar{margin-top:8px; padding:10px; background:var(--primary); border:0; width:100%; border-radius:10px; color:white; font-weight:600; cursor:pointer; transition:0.2s}
.btn-agendar:hover{background:#3c8de0}
.modal-bg{position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.35); display:none; justify-content:center; align-items:center; z-index:80}
.modal{background:white; padding:22px; width:420px; border-radius:var(--radius); text-align:left; box-shadow:0 12px 36px rgba(0,0,0,0.12)}
.modal h2{margin-bottom:8px}
.close{margin-top:18px; background:#ccc; padding:10px 16px; border-radius:10px; cursor:pointer; display:inline-block}
.side-panel{position:fixed; right:-480px; top:28px; width:420px; height:calc(100% - 56px); background:var(--card); box-shadow:-12px 0 40px rgba(0,0,0,0.08); border-radius:12px 0 0 12px; padding:18px; transition:right .32s cubic-bezier(.2,.9,.2,1); z-index:90; overflow:auto}
.side-panel.open{right:20px}
.user-actions{display:flex; gap:8px; align-items:center}
.chips{display:flex; gap:8px; flex-wrap:wrap}
.chip{padding:8px 12px; border-radius:999px; border:1px solid #e6eef8; background:var(--surface); cursor:pointer}
.chip.selected{background:var(--primary); color:white; border-color:transparent}
.price{font-size:22px; font-weight:700}
.favorite{position:absolute; top:12px; right:12px; font-size:20px; cursor:pointer; opacity:.95}
.favorite.active{color:#ff6b84; transform:scale(1.08)}
.onboard{position:fixed; left:0; top:0; right:0; bottom:0; background:rgba(8,12,20,0.6); display:none; align-items:center; justify-content:center; z-index:110}
.onboard.show{display:flex}
.onboard-card{background:var(--card); padding:22px; border-radius:12px; width:520px; text-align:left}
.theme-switch{display:flex; align-items:center; gap:8px; cursor:pointer}
.fab-chat{position:fixed; right:24px; bottom:24px; width:60px; height:60px; border-radius:50%; background:var(--primary); color:white; display:grid; place-items:center; box-shadow:0 12px 30px rgba(16,40,80,0.12); cursor:pointer}
.chat-box{position:fixed; right:24px; bottom:100px; width:320px; height:420px; background:var(--card); border-radius:12px; box-shadow:0 12px 36px rgba(0,0,0,0.12); display:none; flex-direction:column; overflow:hidden; z-index:120}
.chat-box.open{display:flex}
.chat-messages{flex:1; padding:12px; overflow:auto}
.chat-input{display:flex; gap:8px; padding:10px; border-top:1px solid #eef3f8}
.progress-steps{display:flex; gap:8px; align-items:center; margin-top:12px}
.step{flex:1; height:8px; background:#eef3f8; border-radius:999px; overflow:hidden}
.step .bar{height:100%; width:0%; background:var(--primary); transition:width .4s ease}
.accordion{margin-top:12px}
.acc-item{border:1px solid #eef3f8; border-radius:10px; overflow:hidden; margin-bottom:8px}
.acc-head{padding:12px; cursor:pointer; display:flex; justify-content:space-between}
.acc-body{padding:12px; display:none}
.acc-item.open .acc-body{display:block}
.checkmark{width:84px; height:84px; border-radius:999px; display:grid; place-items:center; margin:0 auto;}
.checkmark svg{width:56px; height:56px}
.footer-hint{margin-top:14px; color:var(--muted); font-size:13px}
</style>
</head>
<body>
<div class="wrapper">
    <header class="header">
        <div class="logo">
            <div class="logo-icon">FZ</div>
            <div class="logo-name" style="font-size:22px; font-weight:700;">Faxineiras</div>
        </div>
        <div style="position:relative;">
            <div class="profile">
                <div style="text-align:right">
                    <strong>Ol√°, Maria!</strong><br>
                    <span style="color:var(--muted); font-size:13px;">Bem-vinda</span>
                </div>
                <div class="profile-pic" id="profilePic">MA</div>
            </div>
            <div class="dropdown" id="profileDropdown">
                <div style="font-weight:700; margin-bottom:8px;">Maria Alves</div>
                <div style="font-size:14px; color:var(--muted); margin-bottom:8px;">maria@example.com</div>
                <div style="display:flex; gap:8px; flex-direction:column;">
                    <button class="chip" id="myBookingsBtn">Meus agendamentos</button>
                    <button class="chip" id="paymentsBtn">Pagamentos</button>
                    <button class="chip" id="logoutBtn">Sair</button>
                </div>
            </div>
        </div>
    </header>

    <div class="search-box">
        <input id="searchInput" type="text" placeholder="Buscar faxineira, di√°ria ou servi√ßo‚Ä¶">
        <button class="search-btn" id="searchBtn">Buscar</button>
        <div class="autocomplete" id="autocomplete"></div>
    </div>

    <div style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
        <h3 class="section-title">Categorias</h3>
        <div style="display:flex; gap:12px; align-items:center;">
            <div class="theme-switch" id="themeSwitch">
                <div id="themeIcon">üåô</div>
                <div style="font-size:13px; color:var(--muted);">Modo escuro</div>
            </div>
            <div class="chip" id="onboardToggle">? Ajuda</div>
        </div>
    </div>

    <div class="categories" id="categories">

        <!-- We'll generate cards via JS to attach data easily -->

    </div>

</div>

<!-- MODAL -->
<div class="modal-bg" id="modalBg">
    <div class="modal" role="dialog">
        <h2 id="modalTitle">Agendar</h2>
        <p id="modalSubtitle" style="color:var(--muted);">Selecione data, hor√°rio e confirme seu agendamento.</p>

        <div style="margin-top:12px">
            <label style="font-size:13px; color:var(--muted)">Data</label>
            <input type="date" id="dateInput" style="width:100%; padding:10px; margin-top:6px; border-radius:8px; border:1px solid #eef3f8">
        </div>

        <div style="margin-top:12px">
            <label style="font-size:13px; color:var(--muted)">Hor√°rios</label>
            <div class="chips" id="timeChips" style="margin-top:6px"></div>
        </div>

        <div style="display:flex; justify-content:space-between; align-items:center; margin-top:12px">
            <div>
                <div style="font-size:13px; color:var(--muted)">Valor estimado</div>
                <div class="price" id="estimate">R$ 0,00</div>
            </div>
            <div>
                <button class="chip" id="addExtrasBtn">+ Extras</button>
            </div>
        </div>

        <div class="progress-steps">
            <div class="step"><div class="bar" id="stepBar"></div></div>
            <div style="font-size:13px; color:var(--muted);">Etapa <span id="stepNum">1</span>/3</div>
        </div>

        <div style="margin-top:12px; display:flex; gap:8px;">
            <button class="btn-agendar" id="confirmBtn">Confirmar</button>
            <div class="close" onclick="closeModal()">Fechar</div>
        </div>
    </div>
</div>

<!-- SIDE PANEL -->
<div class="side-panel" id="sidePanel">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <div>
            <div style="font-weight:700" id="panelName">Nome</div>
            <div style="color:var(--muted); font-size:13px" id="panelRole">Servi√ßo</div>
        </div>
        <div class="favorite" id="favoriteBtn" title="Favoritar">‚ô°</div>
    </div>

    <div style="margin-top:12px; display:flex; gap:8px; align-items:center;">
        <div class="cat-icon" id="panelIcon">üßπ</div>
        <div>
            <div style="font-weight:700" id="panelRating">4.5</div>
            <div style="color:var(--muted); font-size:13px">Avalia√ß√µes e disponibilidade</div>
        </div>
    </div>

    <div style="margin-top:12px">
        <div style="font-weight:700; margin-bottom:8px">Escolha tamanho do im√≥vel</div>
        <div class="chips" id="sizeChips">
            <div class="chip" data-mult="0.8">Apartamento 1-2 c√¥modos</div>
            <div class="chip" data-mult="1.0">Apartamento 3-4 c√¥modos</div>
            <div class="chip" data-mult="1.3">Casa / 5+ c√¥modos</div>
        </div>
    </div>

    <div style="margin-top:12px">
        <div style="font-weight:700; margin-bottom:8px">Extras</div>
        <div class="chips" id="extraChips">
            <div class="chip" data-extra="20">Limpeza de geladeira (R$20)</div>
            <div class="chip" data-extra="35">Lavagem de tapetes (R$35)</div>
            <div class="chip" data-extra="50">Lustrar m√≥veis (R$50)</div>
        </div>
    </div>

    <div style="margin-top:18px; display:flex; justify-content:space-between; align-items:center;">
        <div>
            <div style="font-size:13px; color:var(--muted)">Pre√ßo base</div>
            <div class="price" id="panelPrice">R$ 120,00</div>
        </div>
        <div>
            <button class="btn-agendar" id="openModalFromPanel">Agendar</button>
        </div>
    </div>

    <div class="accordion">
        <div class="acc-item">
            <div class="acc-head">O que est√° inclu√≠do <span>‚Ä∫</span></div>
            <div class="acc-body">Varrer, passar pano, polir superf√≠cies e lavar lou√ßa (quando combinado).</div>
        </div>
        <div class="acc-item">
            <div class="acc-head">Pol√≠tica de cancelamento <span>‚Ä∫</span></div>
            <div class="acc-body">Cancelamento gr√°tis at√© 24h antes. Ap√≥s isso, 50% de taxa.</div>
        </div>
    </div>
</div>

<!-- Onboarding -->
<div class="onboard" id="onboard">
    <div class="onboard-card">
        <h2>Bem-vinda ao Faxineiras</h2>
        <p style="color:var(--muted)">Um r√°pido tour: busque servi√ßos, abra perfis, escolha data e confirme.</p>
        <ol style="margin-top:8px; color:var(--muted)">
            <li>Use a busca com sugest√µes autom√°ticas.</li>
            <li>Clique em um cart√£o para ver o perfil e ajustar extras.</li>
            <li>Agende usando o calend√°rio e confirme.</li>
        </ol>
        <div style="display:flex; justify-content:flex-end; gap:8px; margin-top:12px;">
            <button class="chip" id="skipOnboard">Pular</button>
            <button class="btn-agendar" id="startOnboard">Come√ßar</button>
        </div>
    </div>
</div>

<!-- Chat -->
<div class="fab-chat" id="fabChat">üí¨</div>
<div class="chat-box" id="chatBox">
    <div style="padding:12px; border-bottom:1px solid #eef3f8; font-weight:700">Atendimento r√°pido</div>
    <div class="chat-messages" id="chatMessages">
        <div style="font-size:13px; color:var(--muted); margin-top:8px">Como podemos ajudar?</div>
    </div>
    <div class="chat-input">
        <input id="chatInput" placeholder="Escreva sua mensagem..." style="flex:1; padding:8px; border-radius:8px; border:1px solid #eef3f8" />
        <button class="chip" id="sendMsg">Enviar</button>
    </div>
</div>

<script>
// Data
const services = [
    {id:1, icon:'üßπ', label:'Limpeza leve', rating:4.2, base:80},
    {id:2, icon:'ü™£', label:'Limpeza pesada', rating:4.9, base:150},
    {id:3, icon:'üèóÔ∏è', label:'P√≥s-obra', rating:4.4, base:200},
    {id:4, icon:'‚ú®', label:'Organiza√ß√£o', rating:5.0, base:120},
    {id:5, icon:'üßΩ', label:'Faxina completa', rating:4.8, base:180}
];

// render cards
const categories = document.getElementById('categories');
services.forEach(s=>{
    const el = document.createElement('div'); el.className='cat';
    el.innerHTML = `
        <div class="cat-top">
            <div class="cat-icon">${s.icon}</div>
            <div>
                <div class="cat-label">${s.label}</div>
                <div class="stars">${'‚òÖ'.repeat(Math.round(s.rating))} (${s.rating.toFixed(1)})</div>
            </div>
        </div>
        <div style="font-size:13px; color:var(--muted)">A partir de R$ ${s.base.toFixed(2)}</div>
        <button class="btn-agendar" data-id="${s.id}">Abrir perfil</button>
    `;
    categories.appendChild(el);
});

// profile dropdown
const profilePic = document.getElementById('profilePic');
const profileDropdown = document.getElementById('profileDropdown');
profilePic.addEventListener('click', ()=>{
    profileDropdown.classList.toggle('show');
    profilePic.classList.toggle('open');
});

// side panel open
const sidePanel = document.getElementById('sidePanel');
categories.addEventListener('click', (e)=>{
    const btn = e.target.closest('button');
    if(!btn) return;
    const id = +btn.dataset.id;
    const s = services.find(x=>x.id===id);
    if(!s) return;
    openPanel(s);
});

function openPanel(service){
    document.getElementById('panelName').innerText = service.label;
    document.getElementById('panelRole').innerText = 'Servi√ßo dispon√≠vel';
    document.getElementById('panelIcon').innerText = service.icon;
    document.getElementById('panelRating').innerText = `${service.rating.toFixed(1)} ‚òÖ`;
    document.getElementById('panelPrice').innerText = `R$ ${service.base.toFixed(2)}`;
    sidePanel.classList.add('open');
    // reset selections
    document.querySelectorAll('#sizeChips .chip').forEach(c=>c.classList.remove('selected'));
    document.querySelectorAll('#extraChips .chip').forEach(c=>c.classList.remove('selected'));
    currentBase = service.base;
    computePrice();
}

// favorite
const favoriteBtn = document.getElementById('favoriteBtn');
favoriteBtn.addEventListener('click', ()=>{
    favoriteBtn.classList.toggle('active');
    favoriteBtn.innerText = favoriteBtn.classList.contains('active') ? '‚ù§' : '‚ô°';
    // persist
    localStorage.setItem('fav', favoriteBtn.classList.contains('active'));
});
// restore
if(localStorage.getItem('fav')==='true'){favoriteBtn.classList.add('active'); favoriteBtn.innerText='‚ù§'}

// chips behavior
document.querySelectorAll('#sizeChips .chip').forEach(ch=>{
    ch.addEventListener('click', ()=>{
        document.querySelectorAll('#sizeChips .chip').forEach(x=>x.classList.remove('selected'));
        ch.classList.add('selected');
        computePrice();
    });
});

document.querySelectorAll('#extraChips .chip').forEach(ch=>{
    ch.addEventListener('click', ()=>{ ch.classList.toggle('selected'); computePrice(); });
});

let currentBase = services[0].base;
function computePrice(){
    let mult = 1;
    const sizeSelected = document.querySelector('#sizeChips .chip.selected');
    if(sizeSelected) mult = parseFloat(sizeSelected.dataset.mult);
    let extras = 0;
    document.querySelectorAll('#extraChips .chip.selected').forEach(x=>extras += parseFloat(x.dataset.extra||0));
    const total = currentBase * mult + extras;
    document.getElementById('panelPrice').innerText = `R$ ${total.toFixed(2)}`;
    document.getElementById('estimate').innerText = `R$ ${total.toFixed(2)}`;
}

// open modal from panel
document.getElementById('openModalFromPanel').addEventListener('click', ()=>{
    document.getElementById('modalTitle').innerText = 'Agendamento ‚Äî ' + document.getElementById('panelName').innerText;
    openModal();
});

// modal logic
const modalBg = document.getElementById('modalBg');
const dateInput = document.getElementById('dateInput');
const timeChips = document.getElementById('timeChips');
const stepBar = document.getElementById('stepBar');
const stepNum = document.getElementById('stepNum');
let selectedTime = null;
let currentStep = 1;

function openModal(){ modalBg.style.display='flex'; currentStep=1; updateStep(); populateTimes(); }
function closeModal(){ modalBg.style.display='none'; }

function updateStep(){ stepBar.style.width = (currentStep/3*100)+'%'; stepNum.innerText = currentStep; }

dateInput.addEventListener('change', populateTimes);
function populateTimes(){ timeChips.innerHTML=''; selectedTime=null; const times = ['09:00','11:00','13:00','15:00','17:00']; times.forEach(t=>{
    const d = document.createElement('div'); d.className='chip'; d.innerText=t; d.addEventListener('click', ()=>{ document.querySelectorAll('#timeChips .chip').forEach(x=>x.classList.remove('selected')); d.classList.add('selected'); selectedTime=t; currentStep=2; updateStep(); }); timeChips.appendChild(d);
}); }

// confirm
const confirmBtn = document.getElementById('confirmBtn');
confirmBtn.addEventListener('click', ()=>{
    if(currentStep===1){ alert('Escolha uma data e hor√°rio'); return; }
    currentStep=3; updateStep(); // simulate final confirmation with animation
    modalBg.querySelector('.modal').innerHTML = `
        <div style="text-align:center; padding:18px">
            <div class="checkmark" style="background:var(--surface)">
                <svg viewBox="0 0 52 52"><path d="M14 27l7 7 17-17" fill="none" stroke="${getComputedStyle(document.documentElement).getPropertyValue('--primary')||'#4c9ef5'}" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </div>
            <h2>Agendamento confirmado</h2>
            <p style="color:var(--muted)">Agendado para <strong>${dateInput.value || '‚Äî'}</strong> √†s <strong>${selectedTime || '‚Äî'}</strong>.</p>
            <div style="margin-top:12px; display:flex; gap:8px; justify-content:center">
                <button class="chip" id="addCal">Adicionar ao calend√°rio</button>
                <button class="chip" id="closeAfter">Fechar</button>
            </div>
        </div>
    `;
    document.getElementById('closeAfter').addEventListener('click', ()=>{ closeModal(); location.reload(); });
    document.getElementById('addCal').addEventListener('click', ()=>{ downloadICS(); });
});

function downloadICS(){
    const title = document.getElementById('modalTitle').innerText;
    const date = dateInput.value; const time = selectedTime || '09:00';
    if(!date) return alert('Selecione uma data');
    // create simple ICS for user's local timezone (basic)
    const dt = date.split('-'); // YYYY-MM-DD
    const start = `${dt[0]}${dt[1]}${dt[2]}T${time.replace(':','')}00`;
    const ics = `BEGIN:VCALENDAR\nVERSION:2.0\nBEGIN:VEVENT\nSUMMARY:${title}\nDTSTART:${start}\nDTEND:${start}\nEND:VEVENT\nEND:VCALENDAR`;
    const blob = new Blob([ics], {type:'text/calendar;charset=utf-8'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href=url; a.download='agendamento.ics'; a.click(); URL.revokeObjectURL(url);
}

// autocomplete search
const searchInput = document.getElementById('searchInput');
const autocomplete = document.getElementById('autocomplete');
const suggestions = [...services.map(s=>s.label), 'Maria (faxineira)', 'Di√°ria r√°pida', 'Pacote semanal'];
searchInput.addEventListener('input', ()=>{
    const q = searchInput.value.trim().toLowerCase(); if(!q){ autocomplete.classList.remove('show'); return; }
    const matched = suggestions.filter(s=>s.toLowerCase().includes(q)).slice(0,6);
    autocomplete.innerHTML = matched.map(m=>`<div class="item">${m}</div>`).join('');
    autocomplete.classList.add('show');
});
autocomplete.addEventListener('click', (e)=>{ if(e.target.classList.contains('item')){ searchInput.value=e.target.innerText; autocomplete.classList.remove('show'); } });

// onboarding
const onboard = document.getElementById('onboard');
const onboardToggle = document.getElementById('onboardToggle');
const skipOnboard = document.getElementById('skipOnboard');
const startOnboard = document.getElementById('startOnboard');
onboardToggle.addEventListener('click', ()=>{ onboard.classList.toggle('show'); });
skipOnboard.addEventListener('click', ()=>{ onboard.classList.remove('show'); });
startOnboard.addEventListener('click', ()=>{ onboard.classList.remove('show'); localStorage.setItem('seenOnboard','true'); });
if(!localStorage.getItem('seenOnboard')){ onboard.classList.add('show'); }

// theme
const themeSwitch = document.getElementById('themeSwitch');
const themeIcon = document.getElementById('themeIcon');
if(localStorage.getItem('theme')==='dark'){ document.documentElement.setAttribute('data-theme','dark'); themeIcon.innerText='‚òÄÔ∏è'; }
themeSwitch.addEventListener('click', ()=>{
    const isDark = document.documentElement.getAttribute('data-theme')==='dark';
    if(isDark){ document.documentElement.removeAttribute('data-theme'); themeIcon.innerText='üåô'; localStorage.setItem('theme','light'); } else { document.documentElement.setAttribute('data-theme','dark'); themeIcon.innerText='‚òÄÔ∏è'; localStorage.setItem('theme','dark'); }
});

// chat
const fabChat = document.getElementById('fabChat');
const chatBox = document.getElementById('chatBox');
const chatMessages = document.getElementById('chatMessages');
const chatInput = document.getElementById('chatInput');
fabChat.addEventListener('click', ()=> chatBox.classList.toggle('open'));
function addChatMessage(text, who='user'){
    const d = document.createElement('div'); d.style.marginTop='8px'; d.style.fontSize='14px'; d.style.maxWidth='80%'; d.style.padding='8px'; d.style.borderRadius='8px';
    if(who==='user'){ d.style.background='var(--primary)'; d.style.color='white'; d.style.marginLeft='auto'; d.innerText=text; }
    else{ d.style.background='var(--surface)'; d.style.color='var(--text)'; d.innerText=text; }
    chatMessages.appendChild(d); chatMessages.scrollTop = chatMessages.scrollHeight;
}

document.getElementById('sendMsg').addEventListener('click', ()=>{ const t=chatInput.value.trim(); if(!t) return; addChatMessage(t,'user'); chatInput.value=''; setTimeout(()=>addChatMessage('Obrigado! Em que posso ajudar?'),800); });

// accordion
document.querySelectorAll('.acc-item .acc-head').forEach(h=>{ h.addEventListener('click', ()=>{ const item = h.parentElement; item.classList.toggle('open'); }); });

// accordion content click open modal
// clicking outside elements
window.addEventListener('click', (e)=>{
    if(!profilePic.contains(e.target) && !profileDropdown.contains(e.target)){
        profileDropdown.classList.remove('show'); profilePic.classList.remove('open');
    }
});

// quick geolocation hint to suggest nearby professionals
if(navigator.geolocation){ navigator.geolocation.getCurrentPosition((pos)=>{ const lat=pos.coords.latitude.toFixed(2); const lon=pos.coords.longitude.toFixed(2); const hint = document.createElement('div'); hint.className='chip'; hint.style.marginTop='10px'; hint.innerText = `Faxineiras pr√≥ximas em ${lat}, ${lon}`; document.querySelector('.wrapper').insertBefore(hint, document.querySelector('.categories')); }, ()=>{/*ignore*/}); }

// favorite hearts on cards (per-card)
document.querySelectorAll('.cat').forEach((c,i)=>{
    const fav = document.createElement('div'); fav.className='favorite'; fav.style.top='8px'; fav.style.right='8px'; fav.style.position='absolute'; fav.innerText='‚ô°'; c.appendChild(fav);
    if(localStorage.getItem('cardfav_'+i)==='true'){ fav.classList.add('active'); fav.innerText='‚ù§'; }
    fav.addEventListener('click', (ev)=>{ ev.stopPropagation(); fav.classList.toggle('active'); fav.innerText = fav.classList.contains('active')?'‚ù§':'‚ô°'; localStorage.setItem('cardfav_'+i, fav.classList.contains('active')); });
});

// quick packs accordion (implementing packs)
const packsSection = document.createElement('div'); packsSection.style.marginTop='18px'; packsSection.innerHTML = `<div style="font-weight:700; margin-bottom:8px">Packs e ofertas</div><div class="accordion"><div class="acc-item"><div class="acc-head">Pacote Semanal ‚Äî 4 limpezas<span>‚Ä∫</span></div><div class="acc-body">Economize 15% ao contratar semanalmente.</div></div><div class="acc-item"><div class="acc-head">P√≥s-festa ‚Äî limpeza profunda<span>‚Ä∫</span></div><div class="acc-body">Servi√ßo extra com 2 faxineiras e 3h m√≠n.</div></div></div>`;
document.querySelector('.wrapper').appendChild(packsSection);

// Price counter animation when value changes (minimal)
const panelPrice = document.getElementById('panelPrice');
let lastPrice = panelPrice ? parseFloat(panelPrice.innerText.replace(/[R$ ,]/g,'')) : 0;
const obs = new MutationObserver(()=>{ const val = parseFloat(panelPrice.innerText.replace(/[R$ ,]/g,'')); if(!isNaN(val) && val!==lastPrice){ panelPrice.animate([{transform:'scale(.98)'},{transform:'scale(1)'}], {duration:220}); lastPrice=val; } });
if(panelPrice) obs.observe(panelPrice,{childList:true, characterData:true, subtree:true});

// small keyboard accessibility: Enter in search triggers first suggestion
searchInput.addEventListener('keydown',(e)=>{ if(e.key==='Enter'){ const first = autocomplete.querySelector('.item'); if(first){ searchInput.value = first.innerText; autocomplete.classList.remove('show'); } else { document.getElementById('searchBtn').click(); } } });

// quick save for seen onboarding

// initial populate of times
populateTimes();

</script>
</body>
</html>
